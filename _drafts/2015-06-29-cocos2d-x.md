---
layout: post
title: cocos2d-x
---

本文中使用的是3.6版。

开发过iOS，会发现很像，包括界面生命周期、内存管理等。本来它就是从cocos2d进化来的，加了个x是表示多平台。

看着绚丽的游戏，开发起来就知道了背后的琐碎。动画、位置、场景、界面布局等都要用代码去完成。但当看到自己的代码让静态的图片动起来的时候，仿佛自己创造了这个世界，也是很兴奋的！上帝创造这个世界，就是为了让它展示惊喜。

# 坐标

# Directot

# Node
一切皆node。这样便于遍历和管理，逻辑上也归一了。

一直认为设计语言也好，框架也好，所以概念一定要有一个最终的归一。

## Scene
Scene类是Node的子类，和Node相比，只多了一个特性：拥有自己的锚点。

创建时默认会创建一个layer。

## Layer
层。可以组织不同的逻辑功能。

在layer内部是忽略锚点的。

## Sprit
Sprit就是图片。

## Action

Action是一个东西在移动。

### Sequence
一个动作接着一个动作，串行。只有动作的执行时间不定时才用scheduleOnce来代替，来执行延时。

```
// 延时性动作，即FiniteTimeAction
MoveTo* moveTo = MoveTo::create(1.0f, Vec2(100,100));

// C++的lambda，一般需要使用“&”来引用外部变量，需要值引用的话用“=”，或直接写变量名
CallFunc* callFunc = CallFunc::create([&](){

});

Action* actions = Sequence::create(moveTo, callFunc, NULL);

// 这样在sprit执行完moveTo后就会执行回调了
sprit->runAction(actions);

```

说来可笑，在我没有发现Sequence前，我用scheduleOnce来衔接各个动作，计算好时间，来实现回调功能。当时还想怎么逻辑会这么复杂，且紧耦合呢。

### Spawn
所有动作一起动，并行。

## Animation
Animation是以一定的频率在换不同的东西显示

# 内存管理
使用的Objective C的计数方式。

# 调用OC

### 1. 在Classes里定义头文件，如“header.h”，

```
// head.h
class MyClass {
  void hi();
}

```

### 2. 然后在**proj.ios_mac/ios**文件夹里实现。

```
// MyClass.mm

#import”header.h”
void MyClass::hi() {

//Your Objective-C++ code

}
```

这样在编译时就ok，使用时直接#include "header.h"即可。

* https://adriandawid.wordpress.com/2014/09/09/tutorial-use-gamecenter-with-cococs2d-x/

# 感想
看两年前实习时跟着导师做的游戏项目，他的代码就是堆砌，我现在竟然不自觉的会建个父类。这也让我看到了自己的进步。
而且当时糊里糊涂的写，现在也都有概念。

用了些框架，里面的想法都相近：MVC、解耦合等。

时间，在游戏里很重要，如果它在现实里那样重要一样。它控制着整个游戏的显示秩序。

做游戏是让人兴奋的，因为它可以让你去创造一个世界！

# 参考

* 《Cocos2d-x 3.x游戏开发之旅》钟迪龙著