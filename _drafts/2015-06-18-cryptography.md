---
layout: post
title: 密码
---

在读《图解密码技术》，笔记。

平时我们使用的登录密码其实是pin或password，而这里的密码是cryptography，即安全传送消息的方法，通常包括密码算法和密钥等部分。

# 密码与信息安全常识

* 不用使用保密的密码算法
* 使用低强度的密码比不进行任何加密更危险
* 任何密码总有一天都会被破解
* 密码只是信息安全的一部分

# 对称密码（共享密钥密码）

## 异或（XOR）
听着名字很玄乎，其实算法就是相加。

* 0 xor 0 = 0
* 0 xor 1 = 1
* 1 xor 1 = 0
* 1 xor 0 = 1

而且符合加法的交互律和结合律。

在图形上理解就是反转了。硬币最开始都是正面0,反转一次是1,再反正就是0了又。

亦或的这种负负得正的性质很适合加解密。

## 一次性密码本加密

原理是将明文与一串随机的比特序列进行XOR运算。因为在暴力过程中，不仅会有明文出来，还会有其它类似明文的信息出来，从而无法判断哪一个才是正确的。

如加密的明文是“one”,暴力破解的结果中一定会有“one”出来，可是也会有“two”，“onl”等等。

* 密钥要和明文长度相等。
* 如何送密钥呢？用特工人员，所以不太实用。
* 虽然不实用，但思想会一直被用到。不就是密钥不好送吗，那我根据一个短的生成伪随机不就行了吗。太长？那我分组不就行了吗。

## DES
Data Encryption Standard，已经可以在有限时间内被暴力破解了，新的3DES也只能延长寿命。

其使用Feistel轮进行加密和解密。

## AES
Advanced Encryption Standard，取代DES的标准。

使用Rijndeal轮。

# 分组密码的模式

分组密码是每次只能处理特定长度的一块数据的一类密码算法。如DES分组长度是64 bit，AES可以是128 bit，192 bit或256 bit。而流密码对数据流进行连续处理，如一次密码本。

对分组密码算法迭代的方法就是模式。主要有:

  * ECB，Electronic CodeBook，电子密码本。每次的分组密钥相同。
  * CBC，Cipher Block Chaining，密码分组链接。将明文分组与前一个密文分组进行XOR生成分组密钥。推荐使用！
  * CFB，Cipher FeedBack，密码反馈。用相同分组密钥，把前一密文再加密，之后与明文XOR生成新的密文。
  * OFB，Output FeedBack，输出反馈。如上同样反馈，只是反回来的是密码算法的输出。
  * CTR，CounTeT，计数器。用相同的分组密钥，加密逐次累加的计数器生成密码，然后与明文XOR。推荐使用！

模式的名字即生成密文的方式，或生成密钥，如CBC。或使用相同的密钥，如ECB、CFB、OFB和CTR，生成了一次密码本里的密钥，在做XOR。然后对每块再进行DES或AES加密或解密。

这些模式是对一次性密码本加密的实用化。

* 伪随机生成密钥。
* 分组加解密。

# 公钥密码

终于到了神奇的非对称加密！

公钥密码(public-key cryptography)中，密钥分为加密密钥和解密密钥。它们不能单独生成。


## mod——模运算
和12的最大公约数为1的数（5、7、11），在数学上成为“和12互质的数”。

## RSA

在RSA中，明文、密钥和密文都是数字。

### 加密

> 密文 = 明文^E^ mod N

**求E次方的mod N。**

E和N的组合就是公钥。

### 解密

> 明文 = 密文^D^ mod N

**球D次方的mod N。**

D和N的组合就是私钥。

### 生成密钥对
即求E、D和N过程。

首先明白质数：质数（prime number）又称素数，是一个大于1的自然数，除了1和它本身外，不能被其他自然数整除。

* (1)求N

用伪随机数生成器求p和q，p和q都是质数。N = p * q

* (2)求L

L = lcm(p-1, q-1)    # L是p-1和q-1的最小公倍数。

* (3)求E

1 < E < L

gcd(E,L) = 1    # E和L的最大公约数为1（E和L互质）

* (4)求D

1 < D < L

E * D mod L = 1

按照以上过程，我们举个例子：

1. p=5,q=11: N=p*q = 55
2. L=lcm(p-1,q-1)=lcm(4,10) = 20
3. gcd(E,20) => E = 7
4. 7*D mod 20 = 1 => D = 3

所以这对密钥为E=7,D=3,N=55.

测试一下,明文为4,那么:

加密：rsa(4) = 4^7^ mod 55 = 16384 mod 55 = 49

解密：dersa(49) = 49^3^ mod 55 = 4

正确！

隐隐之中感觉到之所以能这么着，和mod的循环脱不了干系，看看那不停在转的时钟吧，“嘀嗒嘀嗒嘀嘀嗒，时钟它不不停在转动；嘀嗒嘀嗒嘀嘀嗒，小雨它拍打着水花...”

吐曹一下：小学一年级学的最小公倍数和最大公约数现在才用到！！！